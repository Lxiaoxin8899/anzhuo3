# 🚀 SmartDosing 快速开始指南

**版本**: v2.0 (数据库集成版)
**更新日期**: 2024-11-24

---

## 第一步：安装应用

### 方法1：使用已构建的APK（推荐）

```bash
# APK位置
app/build/outputs/apk/debug/app-debug.apk

# 安装命令
adb install -r app/build/outputs/apk/debug/app-debug.apk
```

### 方法2：重新构建并安装

```bash
# 清理并构建
./gradlew clean assembleDebug

# 安装
adb install -r app/build/outputs/apk/debug/app-debug.apk
```

---

## 第二步：启动并验证

### 1. 启动应用

在Android设备上点击应用图标启动。

### 2. 查看启动日志

```bash
# Windows
adb logcat | findstr "WebServerManager DBTest"

# Linux/Mac
adb logcat | grep "WebServerManager\|DBTest"
```

### 3. 预期日志输出

```
DBTest: === 开始数据库初始化测试 ===
DBTest: ✅ 数据库已初始化，配方总数: 10
DBTest: === CRUD操作测试全部通过 ===
WebServerManager: Web服务器启动成功，端口: 8080
WebService: Web管理后台已启动: http://192.168.x.x:8080
```

**如果看到以上日志，说明数据库和Web服务都已成功启动！** ✅

---

## 第三步：获取设备IP

### 方法1：查看应用提示（最简单）

应用启动时会显示Toast消息：
```
Web管理后台已启动: http://192.168.x.x:8080
```

记下这个IP地址！

### 方法2：使用ADB命令

```bash
# Windows
adb shell ip -f inet addr show wlan0 | findstr "inet"

# Linux/Mac
adb shell ip -f inet addr show wlan0 | grep "inet "
```

输出示例：
```
inet 192.168.1.100/24 brd 192.168.1.255 scope global wlan0
```

你的设备IP是：`192.168.1.100`

---

## 第四步：测试Web服务

### 1. 修改测试脚本

打开 `test_web_service.bat` (Windows) 或 `test_web_service.sh` (Linux/Mac)

修改第一行的IP地址：
```bash
# 将这里的IP改为你的设备IP
set DEVICE_IP=192.168.1.100
```

### 2. 运行测试脚本

**Windows**:
```bash
test_web_service.bat
```

**Linux/Mac**:
```bash
chmod +x test_web_service.sh
./test_web_service.sh
```

### 3. 预期测试结果

```
✅ Web服务正常运行 (HTTP 200)
✅ 获取配方列表成功
✅ CSV文件导入成功
📊 导入结果：
   - 成功: 10 条
   - 失败: 0 条
```

---

## 第五步：浏览器访问

### 1. 打开浏览器

在电脑或手机浏览器中输入：
```
http://[你的设备IP]:8080
```

例如：`http://192.168.1.100:8080`

### 2. 主要页面

- **首页**: `http://[IP]:8080/`
  - 系统概览
  - 快速操作入口

- **配方管理**: `http://[IP]:8080/recipes`
  - 查看所有配方
  - 搜索和筛选

- **导入配方**: `http://[IP]:8080/import`
  - 上传CSV/Excel文件
  - 批量导入配方

- **统计分析**: `http://[IP]:8080/stats`
  - 配方统计数据
  - 分类分布

---

## 第六步：导入测试配方

### 方法1：使用Web界面（推荐初学者）

1. 访问：`http://[IP]:8080/import`
2. 点击"选择文件"
3. 选择 `test_recipes.csv`
4. 点击"上传导入"
5. 查看导入结果

### 方法2：使用API（推荐开发者）

```bash
# 使用curl命令
curl -X POST http://[你的设备IP]:8080/api/import/recipes \
  -F "file=@test_recipes.csv"
```

### 验证导入成功

**在Web端验证**：
- 访问 `http://[IP]:8080/recipes`
- 应该看到10条测试配方（WEB001-WEB010）

**在Android应用验证**：
1. 打开应用
2. 进入"配方管理"页面
3. 在搜索框输入"Web测试"
4. 应该能看到刚导入的配方

---

## 第七步：测试数据同步

### 测试场景1：Web → Android

1. 在Web端导入配方
2. 在Android应用中查看
3. ✅ 应该能看到新配方

### 测试场景2：Android → Web

1. 在Android应用中删除某个配方
2. 在Web端刷新页面
3. ✅ 配方应该消失

### 测试场景3：搜索和筛选

1. Web端搜索"香精"
2. Android应用也搜索"香精"
3. ✅ 结果应该一致

---

## 常见问题快速解决

### ❌ 问题1：无法访问Web服务

**解决步骤**：
1. 确认Web服务已启动（查看日志）
2. 确认设备IP正确
3. 确认设备和电脑在同一WiFi网络
4. 尝试关闭防火墙

### ❌ 问题2：导入配方后看不到

**解决步骤**：
1. 在Android应用中下拉刷新
2. 切换到其他页面再回来
3. 检查是否有筛选条件
4. 重启应用

### ❌ 问题3：CSV导入失败

**常见原因**：
- 文件编码不是UTF-8
- 缺少必填字段
- 配方编码重复

**解决方案**：
1. 用记事本打开CSV，另存为UTF-8编码
2. 检查第一行是否是标题行
3. 确保配方编码唯一

---

## API快速参考

### 获取配方列表
```bash
curl http://[IP]:8080/api/recipes
```

### 搜索配方
```bash
curl "http://[IP]:8080/api/recipes?search=香精"
```

### 获取统计数据
```bash
curl http://[IP]:8080/api/stats
```

### 导入配方
```bash
curl -X POST http://[IP]:8080/api/import/recipes \
  -F "file=@your_file.csv"
```

### 删除配方
```bash
curl -X DELETE http://[IP]:8080/api/recipes/[配方ID]
```

---

## 下一步学习

### 深入了解
- 📖 [Web服务使用指南](Web服务使用指南.md) - 完整的Web服务文档
- 📖 [数据库集成完成总结](数据库集成完成总结.md) - 技术细节和架构
- 📖 [README_数据库集成](README_数据库集成.md) - 项目概览

### 高级功能
- 使用模板导入
- 批量操作
- 数据导出
- 自定义筛选

### 开发相关
- API文档
- 数据库Schema
- 扩展开发指南

---

## 测试清单

使用以下清单确保所有功能正常：

- [ ] ✅ 应用成功安装并启动
- [ ] ✅ 看到数据库初始化日志
- [ ] ✅ 看到Web服务启动日志
- [ ] ✅ 获取到设备IP地址
- [ ] ✅ 浏览器能访问Web界面
- [ ] ✅ Web端能看到配方列表
- [ ] ✅ 测试脚本执行成功
- [ ] ✅ CSV文件导入成功
- [ ] ✅ Android应用能看到导入的配方
- [ ] ✅ Web端和移动端数据一致

**如果以上全部完成，恭喜你！系统运行正常！** 🎉

---

## 获取帮助

### 查看日志
```bash
# 查看所有日志
adb logcat

# 只看重要日志
adb logcat | grep "WebServerManager\|DBTest\|SmartDosing"
```

### 检查数据库
使用Android Studio的Database Inspector：
1. 打开Android Studio
2. Tools → App Inspection
3. 选择Database Inspector
4. 查看smartdosing.db

### 重置应用
```bash
# 卸载应用（会清除所有数据）
adb uninstall com.example.smartdosing

# 重新安装
adb install -r app/build/outputs/apk/debug/app-debug.apk
```

---

## 总结

你已经成功：
1. ✅ 安装并启动SmartDosing应用
2. ✅ 验证数据库正常工作
3. ✅ 启动Web服务
4. ✅ 通过Web端导入配方
5. ✅ 验证数据在Android和Web端同步

**现在你可以开始使用SmartDosing进行配方管理了！** 🚀

---

**文档版本**: v1.0
**最后更新**: 2024-11-24
**预计阅读时间**: 10分钟
**难度**: ⭐⭐☆☆☆ (简单)

**需要帮助？** 参考完整文档：
- [Web服务使用指南](Web服务使用指南.md)
- [数据库集成完成总结](数据库集成完成总结.md)
